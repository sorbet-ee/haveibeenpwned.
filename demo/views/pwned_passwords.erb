<h2>üîë Pwned Passwords Checker</h2>

<p>Check if a password has been exposed in data breaches. This feature uses k-anonymity to protect your password.</p>

<div class="info">
  <strong>Privacy Note:</strong> Only the first 5 characters of your password's SHA-1 hash are sent to the API.
  Your actual password never leaves your browser in plaintext.
</div>

<form method="post" action="/pwned-passwords">
  <div class="form-group">
    <label for="password">Password to Check:</label>
    <input type="password" id="password" name="password" placeholder="Enter a password" required>
  </div>

  <div class="form-group">
    <label class="checkbox-label">
      <input type="checkbox" name="padding" value="true" checked>
      Use padding (enhanced privacy)
    </label>
  </div>

  <button type="submit">Check Password</button>
</form>

<% if defined?(@error) %>
  <div class="error">
    <strong>Error:</strong> <%= @error %>
  </div>
<% end %>

<% if defined?(@success) && @success %>
  <div class="result <%= @password_safe ? 'success' : 'error' %>">
    <% if @password_safe %>
      <h3>‚úÖ Password is Safe</h3>
      <p>This password has not been found in any known data breaches.</p>
      <p><strong>Note:</strong> While this password hasn't been breached, always use strong, unique passwords for each service.</p>
    <% else %>
      <h3>‚ö†Ô∏è Password Has Been Pwned!</h3>
      <p>This password has been seen <strong><%= @count.to_s.reverse.gsub(/(\d{3})(?=\d)/, '\\1,').reverse %></strong> times in data breaches.</p>
      <p><strong>Do not use this password!</strong> Choose a different, unique password.</p>
    <% end %>

    <h4 style="margin-top: 30px;">Result Details:</h4>
    <pre>{
  "count": <%= @count %>,
  "safe": <%= @password_safe %>
}</pre>
  </div>
<% end %>

<div class="info" style="margin-top: 30px;">
  <h3>How It Works</h3>
  <p>The Pwned Passwords API uses k-anonymity to allow you to check if a password has been compromised without revealing the password itself:</p>
  <ol style="margin-left: 20px; margin-top: 10px;">
    <li>Your password is hashed using SHA-1</li>
    <li>Only the first 5 characters of the hash are sent to the API</li>
    <li>The API returns all hashes starting with those 5 characters</li>
    <li>The gem searches locally for your full hash in the results</li>
  </ol>
</div>

<div class="result" style="margin-top: 30px;">
  <h3>Try These Examples</h3>
  <p>Common passwords to test (these will definitely be pwned):</p>
  <ul style="margin-left: 20px; margin-top: 10px;">
    <li><code>password</code></li>
    <li><code>123456</code></li>
    <li><code>qwerty</code></li>
  </ul>
</div>
